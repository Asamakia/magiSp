# マジックスピリット カード価値計算システム v2.1

作成日: 2025年11月28日

## 概要

カードの「基礎価値」を自動算出するシステム。
基礎価値はカードの性能を数値化したもので、これにレアリティ倍率を掛けることで最終的な市場価値が決まる。

---

## 計算式

```
基礎価値 = (コストベース + スタッツ効率 + 効果キーワード + カードタイプ補正) × キーワード能力倍率
```

---

## 1. コストベース

```javascript
コストベース = カードコスト × 50
```

| コスト | 基礎価値 |
|--------|----------|
| 1 | 50 |
| 2 | 100 |
| 3 | 150 |
| 4 | 200 |
| 5 | 250 |
| 6 | 300 |
| 7 | 350 |
| 8 | 400 |

---

## 2. スタッツ効率（モンスターのみ）

```javascript
スタッツ効率 = (攻撃力 + HP) / コスト × 0.15
上限: 300
```

### 計算例

| カード | 攻撃力 | HP | コスト | 計算 | 結果 |
|--------|--------|-----|--------|------|------|
| フレア・ドラゴン | 1800 | 1500 | 3 | (1800+1500)/3×0.15 | 165 |
| 岩狸・禁忌の熔岩帝 | 3500 | 4200 | 8 | (3500+4200)/8×0.15 | 144 |
| 粘液獣・胞子 | 200 | 250 | 1 | (200+250)/1×0.15 | 68 |

※魔法・フィールド・フェイズカードはスタッツがないため0

---

## 3. 効果キーワード評価

カードの効果テキストに含まれるキーワードを検出し、加算する。
同じキーワードが複数回出現した場合は最大1.5倍まで。

### キーワード一覧と価値

#### 召喚系（高価値）
| キーワード | 価値 |
|------------|------|
| 直接召喚 | +80 |
| コスト不要 | +80 |
| コストなしで | +80 |
| コストなし | +80 |
| コストを払わず | +70 |
| 場に召喚 | +50 |
| 場に戻す | +40 |
| サーチ | +40 |
| 手札に戻す | +35 |
| 手札に加える | +30 |

#### 破壊・ダメージ系
| キーワード | 価値 |
|------------|------|
| 全てのモンスター | +70 |
| 全体に | +60 |
| フィールド全体 | +60 |
| 破壊する | +40 |
| ダメージを与え | +25 |
| 相手プレイヤーに | +20 |

#### ドロー・リソース系
| キーワード | 価値 |
|------------|------|
| 2枚ドロー | +80 |
| ドロー | +50 |
| 1枚ドロー | +50 |
| コスト.*軽減 | +40 |
| SPトークン | +30 |
| アクティブ | +25 |

#### 無効化・妨害系
| キーワード | 価値 |
|------------|------|
| 破壊されない | +70 |
| 効果を受けない | +60 |
| 無効化 | +50 |
| 無効にする | +50 |
| 行動不能 | +45 |
| 攻撃不能 | +40 |

#### 蘇生・復活系
| キーワード | 価値 |
|------------|------|
| 復活 | +50 |
| 蘇生 | +50 |
| 墓地から | +45 |

#### 状態異常系
| キーワード | 価値 |
|------------|------|
| 凍結 | +35 |
| 守護 | +35 |
| 眠り | +30 |
| 毒 | +25 |

#### バフ・回復系
| キーワード | 価値 |
|------------|------|
| 攻撃力.*アップ | +30 |
| ライフ.*回復 | +30 |
| HP.*回復 | +25 |

#### デバフ系
| キーワード | 価値 |
|------------|------|
| 攻撃力.*ダウン | +30 |

#### 技系
| キーワード | 価値 |
|------------|------|
| 上級技 | +60 |
| 基本技 | +30 |

#### 条件系
| キーワード | 価値 |
|------------|------|
| 1度だけ | +20 |
| ターンに1度 | +15 |

---

## 4. カードタイプ補正

| カードタイプ | 補正値 |
|--------------|--------|
| monster | +0 |
| magic | +0 |
| field | +50 |
| phasecard | +40 |

※フィールドとフェイズカードは永続効果を持つため加算

---

## 5. キーワード能力倍率

カードのキーワード能力欄に基づいて最終値に倍率を掛ける。

| キーワード能力 | 倍率 |
|----------------|------|
| 禁忌カード | ×1.8 |
| 死触 | ×1.3 |
| 覚醒 | ×1.25 |
| 刹那詠唱 | ×1.15 |
| 魔障壁 | ×1.1 |
| その他 | ×1.05 |
| なし | ×1.0 |

---

## ティア判定基準

| ティア | 価値範囲 | 目安 |
|--------|----------|------|
| S | 700以上 | 環境を定義する最強カード |
| A | 500-699 | 主要デッキの核となるカード |
| B | 350-499 | 堅実な採用候補 |
| C | 200-349 | 特定デッキで活躍 |
| D | 199以下 | 汎用性低め、初心者向け |

---

## レアリティ体系（10種）

基礎価値にレアリティ倍率を掛けて最終価値を算出。

### 通常レアリティ（5種）

| レアリティ | 名称 | 倍率 | 期待パック数 |
|------------|------|------|--------------|
| C | コモン | ×1.0 | 毎パック2-3枚 |
| UC | アンコモン | ×1.3 | 毎パック1枚 |
| R | レア | ×2.0 | 1-2パック |
| SR | スーパーレア | ×5.0 | 5-6パック |
| UR | ウルトラレア | ×15.0 | 20パック（1箱） |

### 特殊レアリティ（5種）

| レアリティ | 名称 | 倍率 | 期待パック数 | 特徴 |
|------------|------|------|--------------|------|
| HR | ホログラム | ×30.0 | 80パック（4箱） | 全カード対象・キラ加工 |
| SEC | シークレット | ×50.0 | 200パック | 別イラスト |
| ALT | オルタナティブ | ×50.0 | 500パック | 完全別アート（世界観違い） |
| SP | スペシャル | ×60.0 | 1,250パック | イベント・期間限定 |
| GR | ゴッドレア | ×100.0 | 5,000パック | 禁忌カード専用・最高峰 |

### ティア別レアリティ制限

ティアによって出現するレアリティに制限がある。

| ティア | 出現レアリティ | 最低レア |
|--------|----------------|----------|
| S | R / SR / UR / HR / SEC / ALT / SP / GR※ | R |
| A | UC / R / SR / UR / HR / SEC / ALT / SP | UC |
| B | C / UC / R / SR / UR / HR / SEC / ALT / SP | C |
| C | C / UC / R / SR / UR / HR / SEC / ALT / SP | C |
| D | C / UC / R / SR / UR / HR / SEC / ALT / SP | C |

※GRは禁忌カード専用

#### 設計意図

- **Sティア**: 最低でもR。R以上確定枠でしか出ない特別感
- **Aティア**: 最低でもUC。Cよりは希少
- **B〜Dティア**: 全レアリティ対象。初心者でも使える

#### 最低価値の目安

| ティア | 最低レア | 最低価値目安 |
|--------|----------|--------------|
| S (平均1000) | R ×2.0 | 2,000G〜 |
| A (平均550) | UC ×1.3 | 715G〜 |
| B (平均420) | C ×1.0 | 420G〜 |
| C (平均270) | C ×1.0 | 270G〜 |
| D (平均150) | C ×1.0 | 150G〜 |

### パック構成（1パック5枚）

```
枠1: C確定
枠2: C確定
枠3: C/UC（UC 30%）
枠4: C/UC（UC 30%）
枠5: R以上確定枠
```

### 枠5（R以上確定枠）の排出率

| レア | 確率 |
|------|------|
| R | 75% |
| SR | 18% |
| UR | 5% |
| HR | 1.2% |
| SEC | 0.5% |
| ALT | 0.2% |
| SP | 0.08% |
| GR | 0.02% |

### ボックス（20パック = 100枚）期待値

```
C   : 約52枚
UC  : 約28枚
R   : 約15枚
SR  : 約3.6枚
UR  : 約1枚      ← 1箱1枚
HR  : 約0.24枚   ← 4箱に1枚
SEC : 約0.1枚    ← 10箱に1枚
ALT : 約0.04枚   ← 25箱に1枚
SP  : 約0.016枚  ← 60箱に1枚
GR  : 約0.004枚  ← 250箱に1枚
```

### 最終価値の計算例

```
禁忌の鴉王ミラン（基礎価値: 1305）
  C版:   1,305 × 1.0   =    1,305
  UC版:  1,305 × 1.3   =    1,697
  R版:   1,305 × 2.0   =    2,610
  SR版:  1,305 × 5.0   =    6,525
  UR版:  1,305 × 15.0  =   19,575
  HR版:  1,305 × 30.0  =   39,150
  SEC版: 1,305 × 50.0  =   65,250
  ALT版: 1,305 × 50.0  =   65,250
  SP版:  1,305 × 60.0  =   78,300
  GR版:  1,305 × 100.0 =  130,500

フレア・ドラゴン（基礎価値: 360）
  C版:   360 × 1.0   =      360
  UC版:  360 × 1.3   =      468
  R版:   360 × 2.0   =      720
  SR版:  360 × 5.0   =    1,800
  UR版:  360 × 15.0  =    5,400
  HR版:  360 × 30.0  =   10,800
  SEC版: 360 × 50.0  =   18,000
  ALT版: 360 × 50.0  =   18,000
  SP版:  360 × 60.0  =   21,600
  GR版:  対象外（禁忌カードのみ）
```

---

## v2.1 ティア分布（429枚）

| ティア | 枚数 | 割合 |
|--------|------|------|
| S | 18枚 | 4.2% |
| A | 11枚 | 2.6% |
| B | 110枚 | 25.6% |
| C | 202枚 | 47.1% |
| D | 88枚 | 20.5% |

---

## 属性別平均価値

| 属性 | 平均価値 | カード枚数 | Sティア枚数 |
|------|----------|------------|-------------|
| 水 | 347 | 69枚 | 4枚 |
| 炎 | 337 | 60枚 | 3枚 |
| 未来 | 335 | 49枚 | 2枚 |
| 闘 | 326 | 78枚 | 3枚 |
| 原始 | 325 | 51枚 | 3枚 |
| 光 | 306 | 77枚 | 2枚 |
| なし | 250 | 45枚 | 1枚 |

---

## 価値分布の特徴

```
1000+     : 11枚  ← 禁忌カード中心
 600-999  :  8枚  ← 谷間（禁忌と非禁忌の境界）
 500-599  : 10枚
 400-499  : 52枚
 300-399  : 116枚 ← ボリュームゾーン
 200-299  : 144枚 ← 最多
 100-199  : 83枚
    0-99  :  5枚
```

---

## 計算式のJavaScript実装

```javascript
// 効果キーワードの価値定義
const EFFECT_KEYWORDS = {
  // 召喚系
  '直接召喚': 80,
  'コスト不要': 80,
  'コストなしで': 80,
  'コストなし': 80,
  'コストを払わず': 70,
  '場に召喚': 50,
  '場に戻す': 40,
  'サーチ': 40,
  '手札に戻す': 35,
  '手札に加える': 30,
  
  // 破壊・ダメージ系
  '全てのモンスター': 70,
  '全体に': 60,
  'フィールド全体': 60,
  '破壊する': 40,
  'ダメージを与え': 25,
  '相手プレイヤーに': 20,
  
  // ドロー・リソース系
  '2枚ドロー': 80,
  'ドロー': 50,
  '1枚ドロー': 50,
  'コスト.*軽減': 40,
  'SPトークン': 30,
  'アクティブ': 25,
  
  // 無効化・妨害系
  '破壊されない': 70,
  '効果を受けない': 60,
  '無効化': 50,
  '無効にする': 50,
  '行動不能': 45,
  '攻撃不能': 40,
  
  // 蘇生・復活系
  '復活': 50,
  '蘇生': 50,
  '墓地から': 45,
  
  // 状態異常系
  '凍結': 35,
  '守護': 35,
  '眠り': 30,
  '毒': 25,
  
  // バフ・回復系
  '攻撃力.*アップ': 30,
  'ライフ.*回復': 30,
  'HP.*回復': 25,
  
  // デバフ系
  '攻撃力.*ダウン': 30,
  
  // 技系
  '上級技': 60,
  '基本技': 30,
  
  // 条件系
  '1度だけ': 20,
  'ターンに1度': 15,
};

// 基礎価値計算関数
function calculateBaseValue(card) {
  let value = 0;
  
  // 1. コストベース
  value += card.cost * 50;
  
  // 2. スタッツ効率（モンスターのみ）
  if (card.type === 'monster' && card.cost > 0) {
    const statTotal = card.attack + card.hp;
    const efficiency = (statTotal / card.cost) * 0.15;
    value += Math.min(efficiency, 300);
  }
  
  // 3. 効果キーワード評価
  const effect = card.effect || '';
  for (const [keyword, points] of Object.entries(EFFECT_KEYWORDS)) {
    const regex = new RegExp(keyword, 'g');
    const matches = effect.match(regex);
    if (matches) {
      value += points * Math.min(matches.length, 1.5);
    }
  }
  
  // 4. カードタイプ補正
  if (card.type === 'field') value += 50;
  else if (card.type === 'phasecard') value += 40;
  
  // 5. キーワード能力倍率
  let keywordMult = 1.0;
  if (card.keyword) {
    if (card.keyword.includes('禁忌')) keywordMult = 1.8;
    else if (card.keyword.includes('死触')) keywordMult = 1.3;
    else if (card.keyword.includes('覚醒')) keywordMult = 1.25;
    else if (card.keyword.includes('刹那詠唱')) keywordMult = 1.15;
    else if (card.keyword.includes('魔障壁')) keywordMult = 1.1;
    else keywordMult = 1.05;
  }
  
  return Math.round(value * keywordMult);
}

// ティア判定
function determineTier(value) {
  if (value >= 700) return 'S';
  if (value >= 500) return 'A';
  if (value >= 350) return 'B';
  if (value >= 200) return 'C';
  return 'D';
}

// レアリティ別価値計算（10種対応）
function calculateRarityValue(baseValue, rarity) {
  const multipliers = {
    'C': 1.0,      // コモン
    'UC': 1.3,     // アンコモン
    'R': 2.0,      // レア
    'SR': 5.0,     // スーパーレア
    'UR': 15.0,    // ウルトラレア
    'HR': 30.0,    // ホログラム
    'SEC': 50.0,   // シークレット
    'ALT': 50.0,   // オルタナティブ
    'SP': 60.0,    // スペシャル
    'GR': 100.0    // ゴッドレア（禁忌カード専用）
  };
  return Math.round(baseValue * multipliers[rarity]);
}
```

---

## 経済システム

### 通貨（G）

ゲーム内で使用する通貨。カード価値と同じ単位。

#### 入手方法
| 方法 | 獲得量 |
|------|--------|
| 対戦完了 | 5,000G（勝敗問わず） |
| カード売却 | カード価値分のG |

#### 使い道
| 用途 | 価格 |
|------|------|
| パック購入 | 3,500G/パック |
| シングルカード購入 | カード価値と同額 |

---

### 対戦報酬

```
┌─────────────────────────────┐
│      対戦報酬システム        │
├─────────────────────────────┤
│ 対戦完了: 5,000G            │
│ 勝利ボーナス: +1パック       │
└─────────────────────────────┘
```

| 結果 | 報酬 | 価値換算 |
|------|------|----------|
| 敗北 | 5,000G | 5,000G |
| 勝利 | 5,000G + 1パック | 7,597G相当 |

※勝利は敗北の約1.5倍の価値

---

### パック

#### 基本情報
| 項目 | 値 |
|------|-----|
| 価格 | 3,500G |
| 期待値 | 2,597G |
| 期待値比 | 74%（開封は期待値的には損） |
| 枚数 | 5枚/パック |

#### 入手方法
| 方法 | 条件 |
|------|------|
| 対戦報酬 | 勝利時に1パック |
| 通貨購入 | 3,500G |

---

### 1日の進行目安（10戦・勝率50%）

```
獲得G:      50,000G
獲得パック:  5パック（勝利報酬）
────────────────────
Gでパック購入: 14パック分
合計: 約19パック相当/日
```

---

### プレイヤーの選択肢

| 戦略 | 行動 | 特徴 |
|------|------|------|
| ロマン派 | Gでパック購入 | 開封のワクワク、運次第 |
| 効率派 | Gでシングル買い | 確実に欲しいカードGET |
| バランス派 | 勝利パック開封 + シングル買い | 両方楽しむ |

※パック開封は期待値的には損だが、高レアが出れば大当たり

---

## 更新履歴

| バージョン | 日付 | 変更内容 |
|------------|------|----------|
| v1.0 | 2025-11-28 | 初版（文章量ベース） |
| v2.0 | 2025-11-28 | キーワードベースに変更、禁忌倍率2.5→1.8 |
| v2.1 | 2025-11-28 | スタッツ係数0.08→0.15に変更 |
| v2.2 | 2025-11-28 | レアリティ10種体系に拡張（C/UC/R/SR/UR/HR/SEC/ALT/SP/GR） |
| v2.3 | 2025-11-28 | 経済システム追加（対戦報酬5,000G、パック価格3,500G） |
| v2.4 | 2025-11-28 | ティア別レアリティ制限追加（S:R以上、A:UC以上） |

---

## 関連ファイル

- `card_values_v2.1_sorted.csv` - ティア順ソート済み価値一覧
- `card_rarity_values_v2.csv` - レアリティ別価値一覧
- `cardlist.csv` - 元カードデータ（433枚）
