# ãƒã‚¸ãƒƒã‚¯ã‚¹ãƒ”ãƒªãƒƒãƒˆ ã‚³ãƒ¼ãƒ‰æ§‹æˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

æœ€çµ‚æ›´æ–°æ—¥: 2025-11-28
ãƒãƒ¼ã‚¸ãƒ§ãƒ³: 2.0

---

## ğŸ“ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```
/home/user/magiSp/
â”œâ”€â”€ public/                     # é™çš„ãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ cardlist/
â”‚   â”‚   â””â”€â”€ cardlist.csv       # 433æšã®ã‚«ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ï¼ˆCSVå½¢å¼ï¼‰
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ App.js                  # Reactã‚¢ãƒ—ãƒªã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ magic-spirit.jsx        # ãƒ¡ã‚¤ãƒ³ã‚²ãƒ¼ãƒ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆç´„4,700è¡Œï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/                  # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°ç¾¤
â”‚   â”‚   â”œâ”€â”€ constants.js        # ã‚²ãƒ¼ãƒ å®šæ•°å®šç¾©
â”‚   â”‚   â”œâ”€â”€ helpers.js          # ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
â”‚   â”‚   â””â”€â”€ cardManager.js      # ã‚«ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ç®¡ç†
â”‚   â”‚
â”‚   â”œâ”€â”€ components/             # UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ Card.jsx            # ã‚«ãƒ¼ãƒ‰è¡¨ç¤º
â”‚   â”‚   â”œâ”€â”€ FieldMonster.jsx    # ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼è¡¨ç¤º
â”‚   â”‚   â”œâ”€â”€ SPTokens.jsx        # SPãƒˆãƒ¼ã‚¯ãƒ³è¡¨ç¤º
â”‚   â”‚   â””â”€â”€ GameLog.jsx         # ã‚²ãƒ¼ãƒ ãƒ­ã‚°è¡¨ç¤º
â”‚   â”‚
â”‚   â”œâ”€â”€ styles/                 # ã‚¹ã‚¿ã‚¤ãƒ«å®šç¾©
â”‚   â”‚   â””â”€â”€ gameStyles.js       # ã‚²ãƒ¼ãƒ å…¨ä½“ã®ã‚¹ã‚¿ã‚¤ãƒ«
â”‚   â”‚
â”‚   â”œâ”€â”€ engine/                 # ã‚²ãƒ¼ãƒ ãƒ­ã‚¸ãƒƒã‚¯ã‚¨ãƒ³ã‚¸ãƒ³ï¼ˆç´„21,600è¡Œï¼‰â­
â”‚   â”‚   â”œâ”€â”€ effectEngine.js     # æ±ç”¨åŠ¹æœå®Ÿè¡Œã‚¨ãƒ³ã‚¸ãƒ³ï¼ˆ609è¡Œï¼‰
â”‚   â”‚   â”œâ”€â”€ effectHelpers.js    # åŠ¹æœãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ï¼ˆ1,138è¡Œï¼‰
â”‚   â”‚   â”œâ”€â”€ triggerTypes.js     # ãƒˆãƒªã‚¬ãƒ¼ã‚¿ã‚¤ãƒ—å®šç¾©ï¼ˆ520è¡Œï¼‰
â”‚   â”‚   â”œâ”€â”€ triggerEngine.js    # ãƒˆãƒªã‚¬ãƒ¼ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†ï¼ˆ861è¡Œï¼‰
â”‚   â”‚   â”œâ”€â”€ phaseCardEffects.js # ãƒ•ã‚§ã‚¤ã‚ºã‚«ãƒ¼ãƒ‰æ®µéšåŠ¹æœï¼ˆ199è¡Œï¼‰
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ cardEffects/        # ã‚«ãƒ¼ãƒ‰å›ºæœ‰åŠ¹æœå®Ÿè£…ï¼ˆç´„2,900è¡Œï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ index.js        # åŠ¹æœãƒ¬ã‚¸ã‚¹ãƒˆãƒª
â”‚   â”‚   â”‚   â”œâ”€â”€ _template.js    # ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ fire.js         # ç‚å±æ€§åŠ¹æœ
â”‚   â”‚   â”‚   â”œâ”€â”€ water.js        # æ°´å±æ€§åŠ¹æœ
â”‚   â”‚   â”‚   â”œâ”€â”€ light.js        # å…‰å±æ€§åŠ¹æœ
â”‚   â”‚   â”‚   â”œâ”€â”€ dark.js         # é—‡å±æ€§åŠ¹æœ
â”‚   â”‚   â”‚   â”œâ”€â”€ primitive.js    # åŸå§‹å±æ€§åŠ¹æœ
â”‚   â”‚   â”‚   â”œâ”€â”€ future.js       # æœªæ¥å±æ€§åŠ¹æœ
â”‚   â”‚   â”‚   â””â”€â”€ neutral.js      # ãªã—å±æ€§åŠ¹æœ
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ cardTriggers/       # ã‚«ãƒ¼ãƒ‰ãƒˆãƒªã‚¬ãƒ¼å®Ÿè£…ï¼ˆç´„9,700è¡Œã€220+ã‚«ãƒ¼ãƒ‰ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ fireCards.js      # ç‚å±æ€§ãƒˆãƒªã‚¬ãƒ¼
â”‚   â”‚   â”‚   â”œâ”€â”€ waterCards.js     # æ°´å±æ€§ãƒˆãƒªã‚¬ãƒ¼ï¼ˆ1,414è¡Œï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ lightCards.js     # å…‰å±æ€§ãƒˆãƒªã‚¬ãƒ¼ï¼ˆ1,070è¡Œï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ darkCards.js      # é—‡å±æ€§ãƒˆãƒªã‚¬ãƒ¼
â”‚   â”‚   â”‚   â”œâ”€â”€ futureCards.js    # æœªæ¥å±æ€§ãƒˆãƒªã‚¬ãƒ¼
â”‚   â”‚   â”‚   â”œâ”€â”€ primitiveCards.js # åŸå§‹å±æ€§ãƒˆãƒªã‚¬ãƒ¼ï¼ˆ1,489è¡Œï¼‰
â”‚   â”‚   â”‚   â””â”€â”€ neutralCards.js   # ãªã—å±æ€§ãƒˆãƒªã‚¬ãƒ¼
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ continuousEffects/  # å¸¸æ™‚åŠ¹æœã‚·ã‚¹ãƒ†ãƒ ï¼ˆç´„1,850è¡Œã€45ã‚«ãƒ¼ãƒ‰ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ index.js          # ãƒ¡ã‚¤ãƒ³ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ effectTypes.js    # åŠ¹æœã‚¿ã‚¤ãƒ—å®šç¾©
â”‚   â”‚   â”‚   â”œâ”€â”€ targetTypes.js    # ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚¿ã‚¤ãƒ—å®šç¾©
â”‚   â”‚   â”‚   â”œâ”€â”€ conditionChecker.js # æ¡ä»¶ãƒã‚§ãƒƒã‚¯ï¼ˆ329è¡Œï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ valueCalculator.js  # å€¤è¨ˆç®—ï¼ˆ217è¡Œï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ effectEngine.js   # å¸¸æ™‚åŠ¹æœã‚¨ãƒ³ã‚¸ãƒ³ï¼ˆ786è¡Œï¼‰
â”‚   â”‚   â”‚   â””â”€â”€ effectDefinitions/ # ã‚«ãƒ¼ãƒ‰åŠ¹æœå®šç¾©
â”‚   â”‚   â”‚       â”œâ”€â”€ index.js
â”‚   â”‚   â”‚       â”œâ”€â”€ fieldCards.js   # ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰åŠ¹æœ
â”‚   â”‚   â”‚       â”œâ”€â”€ monsterCards.js # ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚«ãƒ¼ãƒ‰åŠ¹æœ
â”‚   â”‚   â”‚       â””â”€â”€ phaseCards.js   # ãƒ•ã‚§ã‚¤ã‚ºã‚«ãƒ¼ãƒ‰åŠ¹æœ
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ statusEffects/      # çŠ¶æ…‹ç•°å¸¸ã‚·ã‚¹ãƒ†ãƒ ï¼ˆç´„1,090è¡Œã€15ç¨®é¡ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ index.js          # ãƒ¡ã‚¤ãƒ³ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ statusTypes.js    # çŠ¶æ…‹ã‚¿ã‚¤ãƒ—å®šç¾©ï¼ˆ400è¡Œï¼‰
â”‚   â”‚   â”‚   â””â”€â”€ statusEngine.js   # çŠ¶æ…‹ç•°å¸¸ã‚¨ãƒ³ã‚¸ãƒ³ï¼ˆ671è¡Œï¼‰
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ keywordAbilities/   # ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰èƒ½åŠ›ã‚·ã‚¹ãƒ†ãƒ ï¼ˆ261è¡Œï¼‰
â”‚   â”‚   â”‚   â””â”€â”€ index.js          # ã€åˆ¹é‚£è© å”±ã€‘ç­‰ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å‡¦ç†
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ ai/                 # AIãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚·ã‚¹ãƒ†ãƒ ï¼ˆç´„1,550è¡Œï¼‰
â”‚   â”‚       â”œâ”€â”€ index.js          # ãƒ¡ã‚¤ãƒ³ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
â”‚   â”‚       â”œâ”€â”€ aiController.js   # AIã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ï¼ˆ554è¡Œï¼‰
â”‚   â”‚       â””â”€â”€ strategies/       # æˆ¦ç•¥å®Ÿè£…
â”‚   â”‚           â”œâ”€â”€ index.js      # æˆ¦ç•¥ã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼
â”‚   â”‚           â”œâ”€â”€ base.js       # åŸºæœ¬æˆ¦ç•¥ï¼ˆãƒ©ãƒ³ãƒ€ãƒ ï¼‰ï¼ˆ231è¡Œï¼‰
â”‚   â”‚           â”œâ”€â”€ easy.js       # ã‹ã‚“ãŸã‚“AI
â”‚   â”‚           â”œâ”€â”€ normal.js     # ãµã¤ã†AIï¼ˆ227è¡Œï¼‰
â”‚   â”‚           â””â”€â”€ hard.js       # ã‚€ãšã‹ã—ã„AIï¼ˆ383è¡Œï¼‰
â”‚   â”‚
â”‚   â””â”€â”€ ãƒ«ãƒ¼ãƒ«/                  # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆé¡
â”‚       â”œâ”€â”€ code-structure.md   # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«
â”‚       â”œâ”€â”€ CHANGELOG.md
â”‚       â”œâ”€â”€ magic-spirit-roadmap-updated.txt
â”‚       â”œâ”€â”€ ai-player-system-design.md
â”‚       â”œâ”€â”€ status-effect-system-design.md
â”‚       â”œâ”€â”€ continuous-effect-system-design.md
â”‚       â”œâ”€â”€ trigger-*.md        # ãƒˆãƒªã‚¬ãƒ¼é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”‚       â””â”€â”€ *.txt               # ã‚²ãƒ¼ãƒ ãƒ«ãƒ¼ãƒ«æ–‡æ›¸
â”‚
â”œâ”€â”€ package.json
â”œâ”€â”€ CLAUDE.md                   # AIé–‹ç™ºè€…å‘ã‘ã‚¬ã‚¤ãƒ‰
â””â”€â”€ README.md

```

---

## ğŸ“„ å„ãƒ•ã‚¡ã‚¤ãƒ«ã®è©³ç´°

### **ãƒ¡ã‚¤ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«**

#### `src/App.js` (Entry Point)
- **å½¹å‰²**: Reactã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
- **å†…å®¹**: `<MagicSpiritGame />` ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
- **è¡Œæ•°**: ç´„10è¡Œ
- **ä¾å­˜**: magic-spirit.jsx

#### `src/magic-spirit.jsx` (Main Game Component) â­æœ€é‡è¦
- **å½¹å‰²**: ã‚²ãƒ¼ãƒ ã®ãƒ¡ã‚¤ãƒ³ãƒ­ã‚¸ãƒƒã‚¯ã¨çŠ¶æ…‹ç®¡ç†
- **è¡Œæ•°**: ç´„4,700è¡Œ
- **å†…å®¹**:
  - ã‚²ãƒ¼ãƒ çŠ¶æ…‹ç®¡ç†ï¼ˆReact hooksï¼‰
  - ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼çŠ¶æ…‹ï¼ˆãƒ©ã‚¤ãƒ•ã€ãƒ‡ãƒƒã‚­ã€æ‰‹æœ­ã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã€å¢“åœ°ï¼‰
  - ã‚²ãƒ¼ãƒ ãƒ•ãƒ­ãƒ¼åˆ¶å¾¡ï¼ˆãƒ•ã‚§ãƒ¼ã‚ºé€²è¡Œã€ã‚¿ãƒ¼ãƒ³ç®¡ç†ï¼‰
  - ã‚«ãƒ¼ãƒ‰å¬å–šå‡¦ç†
  - æˆ¦é—˜å‡¦ç†
  - æŠ€ç™ºå‹•å‡¦ç†
  - AIãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼çµ±åˆ
  - ãƒˆãƒªã‚¬ãƒ¼ã‚·ã‚¹ãƒ†ãƒ çµ±åˆ
  - UI ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
- **ä¾å­˜**:
  - utils/constants.js, helpers.js, cardManager.js
  - engine/* (å…¨ã‚¨ãƒ³ã‚¸ãƒ³ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«)
  - components/Card.jsx, FieldMonster.jsx, SPTokens.jsx, GameLog.jsx
  - styles/gameStyles.js

---

### **ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ï¼ˆsrc/utils/ï¼‰**

#### `constants.js` (Game Constants)
- **å½¹å‰²**: ã‚²ãƒ¼ãƒ å…¨ä½“ã§ä½¿ç”¨ã™ã‚‹å®šæ•°ã‚’å®šç¾©
- **å†…å®¹**:
  - ã‚²ãƒ¼ãƒ å®šæ•°ï¼ˆINITIAL_LIFE, INITIAL_SP, MAX_SPç­‰ï¼‰
  - ãƒ•ã‚§ãƒ¼ã‚ºå®šç¾©ï¼ˆPHASESé…åˆ—ï¼‰
  - å±æ€§ã‚«ãƒ©ãƒ¼å®šç¾©ï¼ˆATTRIBUTE_COLORSï¼‰
  - ã‚«ãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ—ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆTYPE_ICONSï¼‰

#### `helpers.js` (Helper Functions)
- **å½¹å‰²**: æ±ç”¨çš„ãªãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
- **å†…å®¹**:
  - `shuffle(array)`: é…åˆ—ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«
  - `createDeck(cardPool)`: ãƒ‡ãƒƒã‚­ã‚’ç”Ÿæˆï¼ˆ40æšï¼‰
  - `createMonsterInstance(card)`: ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆ
  - `hasCategory(card, category)`: ã‚«ãƒ†ã‚´ãƒªåˆ¤å®šï¼ˆã€ã€‘æ­£è¦åŒ–å¯¾å¿œï¼‰
  - `createDeckFromPrebuilt(deckDef)`: æ§‹ç¯‰æ¸ˆã¿ãƒ‡ãƒƒã‚­ç”Ÿæˆ

#### `cardManager.js` (Card Data Management)
- **å½¹å‰²**: ã‚«ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã¨ç®¡ç†
- **å†…å®¹**:
  - `parseCSV(csvText)`: CSVâ†’ã‚«ãƒ¼ãƒ‰ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå¤‰æ›
  - `parseSkills(effectText)`: æŠ€æƒ…å ±ã‚’æŠ½å‡ºï¼ˆåŸºæœ¬æŠ€ãƒ»ä¸Šç´šæŠ€ï¼‰
  - `SAMPLE_CARDS`: ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ç”¨ã‚µãƒ³ãƒ—ãƒ«ã‚«ãƒ¼ãƒ‰
  - `loadCardsFromCSV()`: CSVãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã‚«ãƒ¼ãƒ‰ã‚’éåŒæœŸèª­ã¿è¾¼ã¿
  - `PREBUILT_DECKS`: æ§‹ç¯‰æ¸ˆã¿ãƒ‡ãƒƒã‚­å®šç¾©

---

### **UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆsrc/components/ï¼‰**

#### `Card.jsx` (Card Display Component)
- **å½¹å‰²**: ã‚«ãƒ¼ãƒ‰ï¼ˆæ‰‹æœ­ãƒ»ãƒ‡ãƒƒã‚­ï¼‰ã®è¡¨ç¤º
- **Props**: card, onClick, selected, small, faceDown, inHand, disabled, modifiedCost, costModifierSource
- **å†…å®¹**:
  - å±æ€§ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³è¡¨ç¤º
  - ã‚³ã‚¹ãƒˆè¡¨ç¤ºï¼ˆä¿®æ­£å€¤ã‚ã‚Šï¼šç·‘/èµ¤ã§è‰²åˆ†ã‘ï¼‰
  - ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã®æ”»æ’ƒåŠ›/HPè¡¨ç¤º
  - æŠ€ã‚¢ã‚¤ã‚³ãƒ³ãƒ»åˆ¹é‚£è© å”±ãƒãƒ¼ã‚«ãƒ¼è¡¨ç¤º

#### `FieldMonster.jsx` (Field Monster Component)
- **å½¹å‰²**: ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ä¸Šã®ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã®è¡¨ç¤º
- **Props**: monster, onClick, selected, canAttack, isTarget, isValidTarget
- **å†…å®¹**:
  - HPãƒãƒ¼è¡¨ç¤º
  - æ”»æ’ƒåŠ›/HPè¡¨ç¤ºï¼ˆãƒãƒ•/ãƒ‡ãƒãƒ•ã§è‰²åˆ†ã‘ï¼‰
  - ãƒãƒ£ãƒ¼ã‚¸æ•°è¡¨ç¤º
  - çŠ¶æ…‹ç•°å¸¸ã‚¢ã‚¤ã‚³ãƒ³è¡¨ç¤º
  - æŠ€ã‚¢ã‚¤ã‚³ãƒ³è¡¨ç¤º

#### `SPTokens.jsx` (SP Token Display)
- **å½¹å‰²**: SPãƒˆãƒ¼ã‚¯ãƒ³ã®è¡¨ç¤º
- **Props**: active, rested, max
- **å†…å®¹**: â—†ï¼ˆã‚¢ã‚¯ãƒ†ã‚£ãƒ–ï¼‰ã€â—‡ï¼ˆãƒ¬ã‚¹ãƒˆï¼‰ã€â—‹ï¼ˆç©ºï¼‰

#### `GameLog.jsx` (Game Log Component)
- **å½¹å‰²**: ã‚²ãƒ¼ãƒ ãƒ­ã‚°ã®è¡¨ç¤º
- **Props**: logs
- **å†…å®¹**: ã‚¿ã‚¤ãƒ—åˆ¥è‰²åˆ†ã‘ï¼ˆdamage: èµ¤ã€heal: ç·‘ã€info: ã‚°ãƒ¬ãƒ¼ï¼‰

---

### **ã‚²ãƒ¼ãƒ ã‚¨ãƒ³ã‚¸ãƒ³ï¼ˆsrc/engine/ï¼‰** â­â­

#### `effectEngine.js` (Generic Effect Engine)
- **å½¹å‰²**: æ±ç”¨çš„ãªã‚«ãƒ¼ãƒ‰åŠ¹æœã®è§£æã¨å®Ÿè¡Œ
- **è¡Œæ•°**: 609è¡Œ
- **å†…å®¹**:
  - `EFFECT_TYPES`: 13ç¨®é¡ã®åŠ¹æœã‚¿ã‚¤ãƒ—å®šç¾©
  - `parseEffect(effectText)`: åŠ¹æœãƒ†ã‚­ã‚¹ãƒˆè§£æ
  - `executeEffect(effect, context)`: åŠ¹æœå®Ÿè¡Œ
  - `executeSkillEffects(skillText, context, cardId)`: ã‚«ãƒ¼ãƒ‰å›ºæœ‰åŠ¹æœå„ªå…ˆã§å®Ÿè¡Œ

#### `effectHelpers.js` (Effect Helper Library) â­æœ€é‡è¦
- **å½¹å‰²**: å†åˆ©ç”¨å¯èƒ½ãªåŠ¹æœãƒ‘ã‚¿ãƒ¼ãƒ³é–¢æ•°
- **è¡Œæ•°**: 1,138è¡Œ
- **ä¸»è¦é–¢æ•°**:
  - `millDeck()`, `millOpponentDeck()`: ãƒ‡ãƒƒã‚­ç ´å£Š
  - `conditionalDamage()`: æ¡ä»¶ä»˜ããƒ€ãƒ¡ãƒ¼ã‚¸
  - `searchCard()`: ãƒ‡ãƒƒã‚­ã‚µãƒ¼ãƒ
  - `reviveFromGraveyard()`: å¢“åœ°è˜‡ç”Ÿï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³å¯¾å¿œï¼‰
  - `destroyMonster()`: ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ç ´å£Š
  - `drawCards()`: ãƒ‰ãƒ­ãƒ¼
  - `healLife()`: å›å¾©
  - `modifyAttack()`, `modifyHP()`: ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´
  - `selectAndApplyStatusToOpponent()`: çŠ¶æ…‹ç•°å¸¸ä»˜ä¸
  - `processStatusEffectsTurnStart()`: ã‚¿ãƒ¼ãƒ³é–‹å§‹æ™‚çŠ¶æ…‹å‡¦ç†
  - `processStatusEffectsEndPhase()`: ã‚¨ãƒ³ãƒ‰ãƒ•ã‚§ã‚¤ã‚ºçŠ¶æ…‹å‡¦ç†

#### `triggerTypes.js` (Trigger Type Definitions)
- **å½¹å‰²**: 27ç¨®é¡ã®ãƒˆãƒªã‚¬ãƒ¼ã‚¿ã‚¤ãƒ—å®šç¾©
- **è¡Œæ•°**: 520è¡Œ
- **å†…å®¹**:
  - `TRIGGER_TYPES`: ON_SUMMON, ON_DESTROY_SELF, ON_END_PHASE_SELFç­‰
  - `ACTIVATION_TYPES`: AUTOMATIC, OPTIONAL
  - `TRIGGER_PRIORITIES`: HIGHESTã€œLOWEST

#### `triggerEngine.js` (Trigger Lifecycle Engine)
- **å½¹å‰²**: ãƒˆãƒªã‚¬ãƒ¼ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†
- **è¡Œæ•°**: 861è¡Œ
- **ä¸»è¦é–¢æ•°**:
  - `registerCardTriggers()`: ã‚«ãƒ¼ãƒ‰å¬å–šæ™‚ã«ãƒˆãƒªã‚¬ãƒ¼ç™»éŒ²
  - `unregisterCardTriggers()`: ã‚«ãƒ¼ãƒ‰ç ´å£Šæ™‚ã«ãƒˆãƒªã‚¬ãƒ¼å‰Šé™¤
  - `fireTrigger()`: è‡ªå‹•ãƒˆãƒªã‚¬ãƒ¼ç™ºç«
  - `activateTrigger()`: ä»»æ„ãƒˆãƒªã‚¬ãƒ¼ç™ºå‹•
  - `getCardMainPhaseTriggers()`: UIè¡¨ç¤ºç”¨ãƒˆãƒªã‚¬ãƒ¼å–å¾—
  - `resetTurnFlags()`: ã‚¿ãƒ¼ãƒ³çµ‚äº†æ™‚ãƒ•ãƒ©ã‚°ãƒªã‚»ãƒƒãƒˆ

#### `phaseCardEffects.js` (Phase Card Stage Parser)
- **å½¹å‰²**: ãƒ•ã‚§ã‚¤ã‚ºã‚«ãƒ¼ãƒ‰ã®æ®µéšåŠ¹æœãƒ‘ãƒ¼ã‚¹
- **è¡Œæ•°**: 199è¡Œ
- **å†…å®¹**:
  - CSVã®effectãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‹ã‚‰æ®µéšåŠ¹æœã‚’æŠ½å‡º
  - ã€ŒåˆæœŸåŠ¹æœ:ã€ã€Œ1æšé‡ã­:ã€ã€Œ2æšé‡ã­:ã€ã€Œ3æšé‡ã­:ã€å½¢å¼å¯¾å¿œ

---

### **ã‚«ãƒ¼ãƒ‰å›ºæœ‰å®Ÿè£…ï¼ˆsrc/engine/cardEffects/ï¼‰**

å„å±æ€§ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚«ãƒ¼ãƒ‰å›ºæœ‰ã®åŠ¹æœå®Ÿè£…ã‚’æ ¼ç´:
- `fire.js`: ç‚å±æ€§ã‚«ãƒ¼ãƒ‰åŠ¹æœ
- `water.js`: æ°´å±æ€§ã‚«ãƒ¼ãƒ‰åŠ¹æœ
- `light.js`: å…‰å±æ€§ã‚«ãƒ¼ãƒ‰åŠ¹æœ
- `dark.js`: é—‡å±æ€§ã‚«ãƒ¼ãƒ‰åŠ¹æœ
- `primitive.js`: åŸå§‹å±æ€§ã‚«ãƒ¼ãƒ‰åŠ¹æœ
- `future.js`: æœªæ¥å±æ€§ã‚«ãƒ¼ãƒ‰åŠ¹æœ
- `neutral.js`: ãªã—å±æ€§ã‚«ãƒ¼ãƒ‰åŠ¹æœ

**å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³**:
```javascript
export const fireCardEffects = {
  C0000XXX: (skillText, context) => {
    if (context.skillType === 'basic') {
      // åŸºæœ¬æŠ€ã®å®Ÿè£…
      return true;
    }
    if (context.skillType === 'advanced') {
      // ä¸Šç´šæŠ€ã®å®Ÿè£…
      return true;
    }
    return false;
  },
};
```

---

### **ãƒˆãƒªã‚¬ãƒ¼å®Ÿè£…ï¼ˆsrc/engine/cardTriggers/ï¼‰**

220æšä»¥ä¸Šã®ã‚«ãƒ¼ãƒ‰ã«ãƒˆãƒªã‚¬ãƒ¼åŠ¹æœã‚’å®Ÿè£…:
- `fireCards.js`: ç‚å±æ€§ãƒˆãƒªã‚¬ãƒ¼
- `waterCards.js`: æ°´å±æ€§ãƒˆãƒªã‚¬ãƒ¼ï¼ˆå¢“åœ°ãƒˆãƒªã‚¬ãƒ¼å«ã‚€ï¼‰
- `lightCards.js`: å…‰å±æ€§ãƒˆãƒªã‚¬ãƒ¼
- `darkCards.js`: é—‡å±æ€§ãƒˆãƒªã‚¬ãƒ¼
- `futureCards.js`: æœªæ¥å±æ€§ãƒˆãƒªã‚¬ãƒ¼
- `primitiveCards.js`: åŸå§‹å±æ€§ãƒˆãƒªã‚¬ãƒ¼
- `neutralCards.js`: ãªã—å±æ€§ãƒˆãƒªã‚¬ãƒ¼ï¼ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰/ãƒ•ã‚§ã‚¤ã‚ºã‚«ãƒ¼ãƒ‰å«ã‚€ï¼‰

**å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³**:
```javascript
export const fireCardTriggers = {
  C0000XXX: [
    {
      type: TRIGGER_TYPES.ON_SUMMON,
      activationType: ACTIVATION_TYPES.AUTOMATIC,
      description: 'å¬å–šæ™‚ã«1æšãƒ‰ãƒ­ãƒ¼',
      effect: (context) => {
        drawCards(context, 1);
      },
    },
  ],
};
```

---

### **å¸¸æ™‚åŠ¹æœã‚·ã‚¹ãƒ†ãƒ ï¼ˆsrc/engine/continuousEffects/ï¼‰**

45æšã®ã‚«ãƒ¼ãƒ‰ã«æ°¸ç¶šåŠ¹æœã‚’å®Ÿè£…:

- **effectTypes.js**: 12ç¨®é¡ã®å¸¸æ™‚åŠ¹æœã‚¿ã‚¤ãƒ—
  - ATK_MODIFIER, HP_MODIFIER, DAMAGE_REDUCTIONç­‰
- **targetTypes.js**: ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚¿ã‚¤ãƒ—å®šç¾©
- **conditionChecker.js**: æ¡ä»¶åˆ¤å®šã‚·ã‚¹ãƒ†ãƒ 
- **valueCalculator.js**: å€¤è¨ˆç®—ï¼ˆå›ºå®šå€¤/ã‚«ã‚¦ãƒ³ãƒˆä¹—ç®—/æ¡ä»¶ä»˜ãï¼‰
- **effectEngine.js**: ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ³ã‚¸ãƒ³
- **effectDefinitions/**: ã‚«ãƒ¼ãƒ‰åˆ¥åŠ¹æœå®šç¾©

---

### **çŠ¶æ…‹ç•°å¸¸ã‚·ã‚¹ãƒ†ãƒ ï¼ˆsrc/engine/statusEffects/ï¼‰**

15ç¨®é¡ã®çŠ¶æ…‹ç•°å¸¸ã‚’ç®¡ç†:

- **statusTypes.js**: çŠ¶æ…‹ã‚¿ã‚¤ãƒ—å®šç¾©
  - SLEEP, FREEZE, THUNDER, WET, STUN, SILENCE
  - GUARD, INVINCIBLE, AWAKENED, ATK_UP, HP_UP, ATK_DOWN
  - PARASITE, POISON, CORRODE
- **statusEngine.js**: ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ³ã‚¸ãƒ³
  - `applyStatus()`: çŠ¶æ…‹ä»˜ä¸
  - `removeStatus()`: çŠ¶æ…‹è§£é™¤
  - `canAttack()`, `canUseSkill()`: è¡Œå‹•åˆ¤å®š
  - `processTurnStart()`, `processEndPhase()`: ãƒ•ã‚§ã‚¤ã‚ºå‡¦ç†
  - `processOpponentEndPhase()`: ç›¸æ‰‹ã‚¨ãƒ³ãƒ‰ãƒ•ã‚§ã‚¤ã‚ºå‡¦ç†ï¼ˆå¯„ç”Ÿç”¨ï¼‰

---

### **AIã‚·ã‚¹ãƒ†ãƒ ï¼ˆsrc/engine/ai/ï¼‰**

3æ®µéšã®é›£æ˜“åº¦ã§AIå¯¾æˆ¦ã‚’ã‚µãƒãƒ¼ãƒˆ:

- **aiController.js**: ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼
  - `createAIGameState()`: ã‚²ãƒ¼ãƒ çŠ¶æ…‹ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ
  - `executeAIMainPhaseAction()`: ãƒ¡ã‚¤ãƒ³ãƒ•ã‚§ã‚¤ã‚ºAI
  - `executeAIBattlePhaseAction()`: ãƒãƒˆãƒ«ãƒ•ã‚§ã‚¤ã‚ºAI
  - ç‰¹æ®Šã‚±ãƒ¼ã‚¹å‡¦ç†: æ‰‹æœ­é¸æŠã€ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã€å¢“åœ°é¸æŠç­‰

- **strategies/**: æˆ¦ç•¥ãƒ‘ã‚¿ãƒ¼ãƒ³
  - `base.js`: åŸºæœ¬æˆ¦ç•¥ï¼ˆãƒ©ãƒ³ãƒ€ãƒ ï¼‰
  - `easy.js`: ã‹ã‚“ãŸã‚“AIï¼ˆ30%å¬å–šã‚¹ã‚­ãƒƒãƒ—ã€70%ãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚¢ã‚¿ãƒƒã‚¯ï¼‰
  - `normal.js`: ãµã¤ã†AIï¼ˆã‚³ã‚¹ãƒˆåŠ¹ç‡ã€HPå„ªå…ˆæ”»æ’ƒï¼‰
  - `hard.js`: ã‚€ãšã‹ã—ã„AIï¼ˆç›¤é¢èªè­˜ã€ãƒ€ãƒ¡ãƒ¼ã‚¸åŠ¹ç‡ï¼‰

---

### **ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰èƒ½åŠ›ï¼ˆsrc/engine/keywordAbilities/ï¼‰**

14ç¨®é¡ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰èƒ½åŠ›ã‚’å‡¦ç†:

- **index.js**: ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å®šç¾©ã¨åˆ¤å®šé–¢æ•°
  - `hasKeyword()`, `getCardKeywords()`: ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰åˆ¤å®š
  - `isSetsunaMagic()`, `getSetsunaCost()`: ã€åˆ¹é‚£è© å”±ã€‘ç”¨
  - `CHAIN_POINTS`: ãƒã‚§ãƒ¼ãƒ³ãƒã‚¤ãƒ³ãƒˆå®šç¾©

---

## ğŸ”„ ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

### ã‚²ãƒ¼ãƒ èµ·å‹•æ™‚
```
1. App.js
   â†“
2. MagicSpiritGameï¼ˆmagic-spirit.jsxï¼‰
   â†“
3. useEffect: loadCardsFromCSV()
   â†“
4. parseCSV() â†’ setAllCards()
   â†“
5. ã‚¿ã‚¤ãƒˆãƒ«ç”»é¢è¡¨ç¤ºï¼ˆãƒ‡ãƒƒã‚­é¸æŠãƒ»AIè¨­å®šï¼‰
```

### ã‚«ãƒ¼ãƒ‰å¬å–šæ™‚
```
1. summonCard(card, slotIndex)
   â†“
2. createMonsterInstance(card)
   â†“
3. continuousEffectEngine.register()  // å¸¸æ™‚åŠ¹æœç™»éŒ²
   â†“
4. registerCardTriggers()  // ãƒˆãƒªã‚¬ãƒ¼ç™»éŒ²
   â†“
5. fireTrigger(ON_SUMMON)  // å¬å–šæ™‚ãƒˆãƒªã‚¬ãƒ¼ç™ºç«
   â†“
6. UIæ›´æ–°
```

### æŠ€ç™ºå‹•æ™‚
```
1. executeSkill(monsterIndex, skillType)
   â†“
2. statusEffectEngine.canUseSkill()  // çŠ¶æ…‹ç•°å¸¸ãƒã‚§ãƒƒã‚¯
   â†“
3. executeSkillEffects(skillText, context, cardId)
   â†“
4. getCardEffect(cardId) â†’ ã‚«ãƒ¼ãƒ‰å›ºæœ‰åŠ¹æœå®Ÿè¡Œ
   â†“ ã¾ãŸã¯
5. parseEffect() â†’ executeEffect()  // æ±ç”¨åŠ¹æœ
   â†“
6. çŠ¶æ…‹æ›´æ–° â†’ UIæ›´æ–°
```

### AIã‚¿ãƒ¼ãƒ³
```
1. AIã‚¿ãƒ¼ãƒ³é–‹å§‹æ¤œå‡º
   â†“
2. executeAIMainPhaseAction()
   â†“
3. æˆ¦ç•¥ã«åŸºã¥ã„ã¦è¡Œå‹•æ±ºå®š
   â†“
4. summonCard() / executeSkill() / nextPhase()
   â†“
5. executeAIBattlePhaseAction()
   â†“
6. æ”»æ’ƒå¯¾è±¡æ±ºå®š â†’ attack()
```

---

## ğŸ“š é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- **é–‹ç™ºã‚¬ã‚¤ãƒ‰**: `/home/user/magiSp/CLAUDE.md`
- **ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—**: `magic-spirit-roadmap-updated.txt`
- **AIã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆ**: `ai-player-system-design.md`
- **çŠ¶æ…‹ç•°å¸¸è¨­è¨ˆ**: `status-effect-system-design.md`
- **å¸¸æ™‚åŠ¹æœè¨­è¨ˆ**: `continuous-effect-system-design.md`
- **ãƒˆãƒªã‚¬ãƒ¼è¨­è¨ˆ**: `trigger-system-design.md`, `trigger-implementation-guide.md`
- **ãƒ«ãƒ¼ãƒ«ä»•æ§˜**: `ãƒã‚¸ãƒƒã‚¯ã‚¹ãƒ”ãƒªãƒƒãƒˆ å…¬å¼ãƒ«ãƒ¼ãƒ«ä»•æ§˜æ›¸ ver2.3.txt`

---

**ä½œæˆæ—¥**: 2025-11-26
**æ›´æ–°æ—¥**: 2025-11-28
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 2.0
